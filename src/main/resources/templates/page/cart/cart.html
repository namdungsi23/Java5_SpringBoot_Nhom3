<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/main-content}">
      
<body>

	<div layout:fragment="content">
		<div class="container my-5">
			<h2 class="mb-4">Giỏ hàng</h2>
	    
		    <!-- Khi giỏ hàng bỏ trống -->
		    <div th:if="${#lists.isEmpty(cartItems)}" class="alert alert-info">
		   	   <p>Hiện tại chưa có sản phẩm nào trong giỏ.</p>
		    </div>
		 
		    <!-- Khi có sản phẩm -->
		    <div class="cart" th:if="${!#lists.isEmpty(cartItems)}">
		    
		    	<!-- BẢNG GIỎ HÀNG -->
		    	<div class="table-responsive">
		    		<table id="cart-table" class="table table-bordered text-center align-middle">
				        <thead class="table-light">
				            <tr>
				                <th>Sản phẩm</th>
				                <th>Giá</th>
				                <th>Số lượng</th>
				                <th>Tạm tính</th>
				                <th>Xóa</th>
				            </tr>
				        </thead>
				        <tbody>
				            <tr th:each="item : ${cartItems}">
				                <td class="text-start fw-semibold" th:text="${item.name}"></td>
				
				                <td th:text="${#numbers.formatDecimal(item.price,0,'COMMA',0,'POINT')} + ' đ'"></td>
				
				                <!-- UPDATE QTY -->
				                <td>
				                    <form th:action="@{/cart/update}" method="post">
				                        <input type="hidden" name="id" th:value="${item.productId}">
				                        <input type="number"
				                               name="qty"
				                               min="1"
				                               th:value="${item.quantity}"
				                               class="form-control form-control-sm text-center"
				                               onblur="this.form.submit()">
				                    </form>
				                </td>
				
				                <td class="fw-bold text-danger"
				                	th:text="${#numbers.formatDecimal(item.price * item.quantity,0,'COMMA',0,'POINT')} + ' đ'"></td>
				
				                <!-- XÓA 1 ITEM -->
				                <td>
				                    <form th:action="@{/cart/remove}" method="post">
				                        <input type="hidden" name="id" th:value="${item.productId}">
				                        <button class="btn btn-sm btn-outline-danger"
				                        		type="submit">
				                        	<i class="bi bi-trash"></i>		
		                        		</button>
				                    </form>
				                </td>
				            </tr>
				        </tbody>
				    </table>
		    	</div>
			    
			    <!-- TỔNG TIỀN -->
			    <div id="cart-total" class="my-2">
			        <strong>Tổng tiền:</strong>
			        <span class="fw-bold text-danger"
			         	  th:text="${#numbers.formatDecimal(amount,0,'COMMA',0,'POINT')} + ' đ'"></span>
			    </div>
			
			    <!-- CART BUTTONS -->
			    <div class="cart-btns">
			        <a href="/product" class="btn btn-success">Tiếp tục mua</a>
			
			        <form th:action="@{/cart/clear}" method="post" style="display:inline">
			            <button class="btn btn-danger px-4">Xóa giỏ hàng</button>
			        </form>
			
			        <a href="/cart/checkout" class="btn btn-primary"> Thanh toán</a>
			    </div>	
		    </div>
	    
		</div>
	    
	</div>

</body>
</html>



